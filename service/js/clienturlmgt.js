$(function() {    $.ajaxSetup({        async: false    });    $.getScript("lib/sp-lib/md5.js");    $.getScript("lib/sp-lib/extent.js");    $.ajaxSetup({        async: true    });    SPUrlMgt.WebMain();});var SPUrlMgt = {    WebMain: function() {        SPUrlMgt.InitEvent();        SPUrlMgt.InitPage();        SPUrlMgt.PreloadImg();    },    InitEvent: function() {        $("#Btn_Add_Url").mouseover(function() {            $(this).attr("src", "images/btn_addurl_hover.gif");        }).mousedown(function() {            $(this).attr("src", "images/btn_addurl_down.gif");        }).mouseup(function() {            $(this).attr("src", "images/btn_addurl_hover.gif");        }).mouseout(function() {            $(this).attr("src", "images/btn_addurl_normal.gif");        }).click(SPUrlMgt.AddUrlOnline);        $("#Btn_Close_Introduce").hover(function() {            $(this).attr("src", "images/btn_close_hover.gif");        },        function() {            $(this).attr("src", "images/btn_close_normal.gif");        }).click(SPUrlMgt.CloseIntroduce);        $("#RD_SortNum").click(SPUrlMgt.SortUrlList);        $("#RD_SortName").click(SPUrlMgt.SortUrlList);        $("#A_Show_Introduce").click(SPUrlMgt.ShowIntroduce);        $("#A_Add_Url").click(SPUrlMgt.AddUrlOnline);        $("#CBox_All_A").click(SPUrlMgt.SelectAll);        $("#CBox_All_B").click(SPUrlMgt.SelectAll);        $("#A_Start_All").click(SPUrlMgt.StartAll);        $("#A_Stop_All").click(SPUrlMgt.StopAll);        $("#A_Delete_All").click(SPUrlMgt.DeleteAll);        $("#A_SetUrl_All").click(SPUrlMgt.MoreSetUrl);        $("#A_Trust_All").click(SPUrlMgt.StartMoreTrustee);        $("#A_Optimize_All").click(SPUrlMgt.StartMoreOptimize);        if ("no" == Cookies.get("introduce")) {            $("#Table_Introduce").hide();            $("#A_Show_Introduce").show();        } else {            $("#Table_Introduce").show();            $("#A_Show_Introduce").hide();        }        SPUrlMgt.JustHeight();    },    InitPage: function() {        SPUrlMgt.m_objTBody = $("#TBody_Template");        SPUrlMgt.m_objTRItem = SPUrlMgt.m_objTBody.children(":first-child");        SPUrlMgt.LoadUserInfo();        SPUrlMgt.LoadUrlInfo();    },    Unload: function() {},    PreloadImg: function() {},    JustHeight: function() {        try {            parent.SPWebApp.m_objIframe.css("height", document.body.scrollHeight);            parent.SPWebApp.JustHeight();        } catch(e) {}    },    LoadUserInfo: function() {        $.post(g_webaction, {            f: 7        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                try {                    parent.SPWebApp.m_objUser = jsonObj;                    parent.SPWebApp.LoadUserInfo();                    $("#Span_User_Name").html(parent.SPWebApp.m_objUser.name);                } catch(e) {}            } else {                alert("登录超时，请重新登录...");                parent.document.location = "clientindex.php";            }        });    },    LoadUrlInfo: function() {        var objLoad = {};        var sortcookie = Cookies.get("sorttype");        if ((null == sortcookie) || ("0" == sortcookie)) {            sortcookie = "0";            $("#RD_SortNum").attr("checked", "true");            $("#RD_SortName").removeAttr("checked");        } else {            $("#RD_SortName").attr("checked", "true");            $("#RD_SortNum").removeAttr("checked");        }        objLoad.sortype = sortcookie;        $.post(g_webaction, {            f: 20,            i: String($.toJSON(objLoad))        },        function(json) {            var jsonObj = $.evalJSON(json);            if (0 == jsonObj.error) {                SPUrlMgt.m_objOnline.nowonline = 0;                SPUrlMgt.AddUrlToList(jsonObj);                SPUrlMgt.m_objOnline.tdonline = jsonObj.tdonline;                SPUrlMgt.m_objOnline.totalurl = jsonObj.urls.length;                $("#Span_Now_OnLine").html(SPUrlMgt.m_objOnline.nowonline);                $("#Span_Today_OnLine").html(SPUrlMgt.m_objOnline.tdonline);                $("#Span_TotalUrl_Count").html(SPUrlMgt.m_objOnline.totalurl);            }        });    },    AddUrlToList: function(jsonObj) {        var nUrlCount = jsonObj.urls.length;        for (var i = 0; i < nUrlCount; i++) {            var objUrl = jsonObj.urls[i];            SPUrlMgt.AddUrlItem(objUrl, i);        }    },    AddUrlItem: function(objItem, nLine) {        var objTrustee = SPUrlMgt.GetTrustee(objItem);        var objOptimize = SPUrlMgt.GetOptimize(objItem);        var newTRItem = SPUrlMgt.m_objTRItem.clone(true);        newTRItem.show();        if (0 == (nLine % 2)) {            newTRItem.children().attr("class", "listOdd");        } else {            newTRItem.children().attr("class", "listEven");        }        newTRItem.children().eq(0).children(":first-child").attr("id", "id_" + objItem.urlid).data("objItem", objItem).click(SPUrlMgt.SelectOne);        SPUrlMgt.m_arrCBox.push(newTRItem.children().eq(0).children(":first-child"));        if ((undefined != objTrustee.odrid) && (0 != objTrustee.status)) {            switch (parseInt(objTrustee.svcid)) {            case 101:                newTRItem.children().eq(1).css("color", "#800000").html("1000IP");                break;            case 102:                newTRItem.children().eq(1).css("color", "#800000").html("2000IP");                break;            case 103:                newTRItem.children().eq(1).css("color", "#800000").html("3000IP");                break;            case 106:                newTRItem.children().eq(1).css("color", "#800000").html("6000IP");                break;            case 110:                newTRItem.children().eq(1).css("color", "#800000").html("10000IP");                break;            case 115:                newTRItem.children().eq(1).css("color", "#800000").html("15000IP");                break;            case 120:                newTRItem.children().eq(1).css("color", "#800000").html("20000IP");                break;            default:                newTRItem.children().eq(1).css("color", "#800000").html("3000IP");                break;            }        } else if ((undefined != objOptimize.odrid) && (0 != objOptimize.status)) {            newTRItem.children().eq(1).css("color", "#800000").html("优化");        } else {            newTRItem.children().eq(1).css("color", "#777777").html("免费");        }        newTRItem.children().eq(2).html(objItem.urlid);        newTRItem.children().eq(3).attr("title", objItem.name).html(objItem.name);        newTRItem.children().eq(4).find("td").eq(0).attr("title", objItem.url).html(objItem.url);        newTRItem.children().eq(4).find("td").eq(1).find("a").click(function() {            $(this).parent().parent().parent().parent().parent().parent().children().eq(8).find("a").click();        });        newTRItem.children().eq(5).html(objItem.tdclick);        if ("0" == objItem.online) {            newTRItem.children().eq(6).find("td").eq(0).css("color", "#a1a1a1").html("离线");        } else {            newTRItem.children().eq(6).find("td").eq(0).css("color", "#25A725").html("在线");            SPUrlMgt.m_objOnline.nowonline++;        }        if ("1" == objItem.free) {            newTRItem.children().eq(6).find("td").eq(1).find("a").css("color", "#56AAD4").html("停止分享").click(SPUrlMgt.ControlUrlOnline);        } else {            newTRItem.children().eq(6).find("td").eq(1).find("a").css("color", "green").html("开启分享").click(SPUrlMgt.ControlUrlOnline);        }        newTRItem.children().eq(7).find("a").click(SPUrlMgt.SetFlowLine);        newTRItem.children().eq(8).find("a").click(SPUrlMgt.SetOptimize);        if (undefined != objTrustee.odrid) {            SPUrlMgt.UpdateTrustee(newTRItem, objTrustee);        } else {            var aObj = $('<a style="color:#13A013;" target="_self" href="javascript:void(0)">立即开通</a>');            aObj.click(SPUrlMgt.StartTrustee);            newTRItem.children().eq(9).empty().append(aObj);        }        if (undefined != objOptimize.odrid) {            SPUrlMgt.UpdateOptimize(newTRItem, objOptimize);        } else {            var aObj = $('<a style="color:#13A013;" target="_self" href="javascript:void(0)">立即开通</a>');            aObj.click(SPUrlMgt.StartOptimize);            newTRItem.children().eq(10).empty().append(aObj);        }        SPUrlMgt.m_objTBody.append(newTRItem);        SPUrlMgt.JustHeight();    },    UpdateTrustee: function(newTRItem, objTrustee) {        var objTable = $('<table cellpadding="0" width="100%"><tr><td style="width:80%;height:100%;padding-left:10px;"><a style="color:#56AAD4;" title="点击查看详情" target="_self" href="javascript:void(0)"></a></td><td style="width:20%;"><a style="color:#56AAD4;" target="_self" href="javascript:void(0)"></a></td></tr></table>');        newTRItem.children().eq(9).empty().append(objTable);        var lsTime = parseInt(objTrustee.sday);        var strTime = "剩";        var nDay = Math.floor(lsTime / 1440);        var nHour = Math.floor((lsTime - nDay * 1440) / 60);        var nMinute = lsTime - (nDay * 1440 + nHour * 60);        strTime += nDay + "天" + nHour + "时" + nMinute + "分";        if ("0" == objTrustee.status) {            newTRItem.children().eq(9).find("a").eq(0).css("color", "#808080").html("余额不足");            newTRItem.children().eq(9).find("a").eq(1).css("color", "#808080").html("退订").unbind("click").click(SPUrlMgt.TrusteeRebackEx);        } else {            if (nDay < 5) {                newTRItem.children().eq(9).find("a").eq(0).css("color", (nDay > 0) ? "blue": "red").html(strTime);                newTRItem.children().eq(9).find("a").eq(1).css("color", (nDay > 0) ? "blue": "red").html("续费").unbind("click").click(SPUrlMgt.ContinueTrustee);            } else {                newTRItem.children().eq(9).find("a").eq(0).css("color", "#5AACD5").html(strTime);                newTRItem.children().eq(9).find("a").eq(1).css("color", "#5AACD5").html("续费").unbind("click").click(SPUrlMgt.ContinueTrustee);            }        }        newTRItem.children().eq(9).find("a").eq(0).unbind("click").click(SPUrlMgt.ViewTrustee);    },    UpdateOptimize: function(newTRItem, objOptimize) {        var objTable = $('<table cellpadding="0" width="100%"><tr><td style="width:80%;height:100%;padding-left:10px;"><a style="color:#56AAD4;" title="点击查看详情" target="_self" href="javascript:void(0)"></a></td><td style="width:20%;"><a style="color:#56AAD4;" target="_self" href="javascript:void(0)"></a></td></tr></table>');        newTRItem.children().eq(10).empty().append(objTable);        var lsTime = parseInt(objOptimize.sday);        var strTime = "剩";        var nDay = Math.floor(lsTime / 1440);        var nHour = Math.floor((lsTime - nDay * 1440) / 60);        var nMinute = lsTime - (nDay * 1440 + nHour * 60);        strTime += nDay + "天" + nHour + "时" + nMinute + "分";        if ("0" == objOptimize.status) {            newTRItem.children().eq(10).find("a").eq(0).css("color", "#808080").html("余额不足");            newTRItem.children().eq(10).find("a").eq(1).css("color", "#808080").html("退订").unbind("click").click(SPUrlMgt.OptimizeRebackEx);        } else {            if (nDay < 5) {                newTRItem.children().eq(10).find("a").eq(0).css("color", (nDay > 0) ? "blue": "red").html(strTime);                newTRItem.children().eq(10).find("a").eq(1).css("color", (nDay > 0) ? "blue": "red").html("续费").unbind("click").click(SPUrlMgt.ContinueOptimize);            } else {                newTRItem.children().eq(10).find("a").eq(0).css("color", "#5AACD5").html(strTime);                newTRItem.children().eq(10).find("a").eq(1).css("color", "#5AACD5").html("续费").unbind("click").click(SPUrlMgt.ContinueOptimize);            }        }        newTRItem.children().eq(10).find("a").eq(0).unbind("click").click(SPUrlMgt.ViewOptimize);    },    AddUrlOnline: function() {        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenAddUrl();    },    SubmitAddUrl: function(objAdd) {        $.post(g_webaction, {            f: 21,            i: String($.toJSON(objAdd))        },        function(json) {            var jsonObj = $.evalJSON(json);            if (0 == jsonObj.error) {                SPUrlMgt.AddUrlItem(jsonObj, SPUrlMgt.m_objOnline.totalurl);                parent.SPWebApp.AddurlSucced(jsonObj.urlid);                $("#Span_TotalUrl_Count").html((++SPUrlMgt.m_objOnline.totalurl));                if (0 != objAdd.tid) {                    var objInfo = {};                    objInfo.srcurlid = objAdd.tid;                    objInfo.descurlids = [];                    objInfo.descurlids.push(jsonObj.urlid);                    SPUrlMgt.CloneSetInfo(objInfo);                } else {                    Cookies.clear("template");                }            } else if ("-22" == jsonObj.error) {                alert("您的域名已被列入黑名单，可能原因有：\n1、网站感染病毒；\n2、域名所有人已申请屏蔽；\n3、域名指向敏感信息内容；\n如果您的网站感染病毒，请在清理后发邮\n件至'spiritsoft@126.com'申请开通！");            } else if ("-21" == jsonObj.error) {                alert("您的网址含有非法字符，请修改后重试！");            } else if ("-4" == jsonObj.error) {                alert("已达到最大网址数，请升级用户等级！");            } else {                alert("网络忙，请稍后再继续添加！");            }        });    },    ControlUrlOnline: function() {        var objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        var objItem = objCBox.data("objItem");        var objControl = {};        if (arguments.length > 1) {            objControl.free = arguments[arguments.length - 1];        } else {            if ("1" == objItem.free) {                objControl.free = 0;            } else {                objControl.free = 1;            }            if (0 == objControl.free) {                if (!window.confirm("停止分享后您的网址将不能继续分享流量，您确认要停止吗？")) {                    return;                }            }        }        objControl.urlid = objItem.urlid;        $.post(g_webaction, {            f: 24,            i: String($.toJSON(objControl))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                objItem.free = objControl.free;                var objTrustee = SPUrlMgt.GetTrustee(objItem);                if ("1" == objItem.free) {                    objCBox.parent().parent().children().eq(6).find("td").eq(1).find("a").css("color", "#56AAD4").html("停止分享");                    if (undefined != objTrustee.odrid) {                        objCBox.parent().parent().children().eq(6).find("td").eq(0).css("color", "#25A725").html("在线");                    }                } else {                    objCBox.parent().parent().children().eq(6).find("td").eq(1).find("a").css("color", "green").html("开启分享");                    if (undefined != objTrustee.odrid) {                        objCBox.parent().parent().children().eq(6).find("td").eq(0).css("color", "#a1a1a1").html("离线");                    }                }                objCBox.data("objItem", objItem);            } else {                alert("处理失败，请重试");            }        });    },    GetTrustee: function(objItem) {        for (var i = 0; i < objItem.odrs.length; i++) {            if (("8" == objItem.odrs[i].svcid) || ("101" == objItem.odrs[i].svcid) || ("102" == objItem.odrs[i].svcid) || ("103" == objItem.odrs[i].svcid) || ("106" == objItem.odrs[i].svcid) || ("110" == objItem.odrs[i].svcid) || ("115" == objItem.odrs[i].svcid) || ("120" == objItem.odrs[i].svcid)) {                return objItem.odrs[i];            }        }        return {};    },    GetOptimize: function(objItem) {        for (var i = 0; i < objItem.odrs.length; i++) {            if ("10" == objItem.odrs[i].svcid) {                return objItem.odrs[i];            }        }        return {};    },    SetFlowLine: function() {        var urlid = $(this).parent().parent().children().eq(0).children(":first-child").data("objItem").urlid;        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenFlowLine(urlid);    },    SubmitFlow: function(strJson) {        $.post(g_webaction, {            f: 25,            i: String(strJson)        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                parent.SPWebApp.SetFlowSucced();            } else {                alert("保存失败，请重试！")            }        });    },    SetOptimize: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenOptimize(SPUrlMgt.m_objCBox.data("objItem"));    },    SubmitOptimize: function(objMod) {        $.post(g_webaction, {            f: 22,            i: String($.toJSON(objMod))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                var objItem = SPUrlMgt.m_objCBox.data("objItem");                objItem.url = objMod.url;                objItem.name = objMod.name;                objItem.usepop = objMod.usepop;                objItem.turl = objMod.turl;                objItem.useturl = objMod.useturl;                objItem.furls = objMod.furls;                objItem.usefurl = objMod.usefurl;                SPUrlMgt.m_objCBox.data("objItem", objItem);                SPUrlMgt.m_objCBox.parent().parent().children().eq(3).attr("title", objItem.name).html(objItem.name);                SPUrlMgt.m_objCBox.parent().parent().children().eq(4).find("td").eq(0).attr("title", objItem.url).html(objItem.url);                parent.SPWebApp.SetOptimizeSucced();            } else {                alert("修改网址失败，请重试");            }        });    },    StartTrustee: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenTrustee(SPUrlMgt.m_objCBox.data("objItem"), false);    },    SubmitTrustee: function(objTrustee) {        $.post(g_webaction, {            f: 32,            i: String($.toJSON(objTrustee))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                SPUrlMgt.UpdateTrusteeData(SPUrlMgt.m_objCBox, jsonObj);                parent.SPWebApp.TrusteeSucced(jsonObj);                SPUrlMgt.LoadUserInfo();            } else {                alert("处理失败，请重试...");            }        });    },    ViewTrustee: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenViewTrustee(SPUrlMgt.m_objCBox.data("objItem"));    },    ContinueTrustee: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenTrustee(SPUrlMgt.m_objCBox.data("objItem"), true);    },    TrustReback: function(bUI) {        if (!window.confirm("您确认要退订网址代挂服务吗？")) {            return;        }        var objItem = SPUrlMgt.m_objCBox.data("objItem");        var objTrustee = SPUrlMgt.GetTrustee(objItem);        var objUnTrustee = {};        objUnTrustee.urlid = objItem.urlid;        objUnTrustee.odrid = objTrustee.odrid;        objUnTrustee.svcid = objTrustee.svcid;        $.post(g_webaction, {            f: 33,            i: String($.toJSON(objUnTrustee))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                if (bUI) {                    parent.SPWebApp.RebackTrusteeSucced(jsonObj.bdelete);                }                var objItem = SPUrlMgt.m_objCBox.data("objItem");                if ("1" == jsonObj.bdelete) {                    for (var i = 0; i < objItem.odrs.length; i++) {                        if (("8" == objItem.odrs[i].svcid) || ("101" == objItem.odrs[i].svcid) || ("102" == objItem.odrs[i].svcid) || ("103" == objItem.odrs[i].svcid) || ("106" == objItem.odrs[i].svcid) || ("110" == objItem.odrs[i].svcid) || ("115" == objItem.odrs[i].svcid) || ("120" == objItem.odrs[i].svcid)) {                            var odrid = objItem.odrs[i].odrid;                            objItem.odrs = $.map(objItem.odrs,                            function(obj) {                                return (odrid == obj.odrid) ? null: obj;                            });                        }                    }                    var aObj = $('<a style="color:#13A013;" target="_self" href="javascript:void(0)">立即开通</a>');                    aObj.click(SPUrlMgt.StartTrustee);                    SPUrlMgt.m_objCBox.parent().parent().children().eq(9).empty().append(aObj);                } else {                    for (var i = 0; i < objItem.odrs.length; i++) {                        if (("8" == objItem.odrs[i].svcid) || ("101" == objItem.odrs[i].svcid) || ("102" == objItem.odrs[i].svcid) || ("103" == objItem.odrs[i].svcid) || ("106" == objItem.odrs[i].svcid) || ("110" == objItem.odrs[i].svcid) || ("115" == objItem.odrs[i].svcid) || ("120" == objItem.odrs[i].svcid)) {                            objItem.odrs[i].etime = jsonObj.etime;                            objItem.odrs[i].sday = jsonObj.sday;                        }                    }                    SPUrlMgt.UpdateTrustee(SPUrlMgt.m_objCBox.parent().parent(), SPUrlMgt.GetTrustee(objItem));                }                var objTrustee = SPUrlMgt.GetTrustee(objItem);                var objOptimize = SPUrlMgt.GetOptimize(objItem);                if ((undefined == objTrustee.odrid) && (undefined == objOptimize.odrid)) {                    SPUrlMgt.m_objCBox.parent().parent().children().eq(1).css("color", "#777777").html("免费");                }                SPUrlMgt.m_objCBox.data("objItem", objItem);            } else {                alert("处理失败，请重试...");            }        });    },    TrusteeRebackEx: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        SPUrlMgt.TrustReback(false);    },    StartOptimize: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenOptimizeSvr(SPUrlMgt.m_objCBox.data("objItem"), false);    },    SubmitOptimizeSvr: function(objOptimize) {        $.post(g_webaction, {            f: 32,            i: String($.toJSON(objOptimize))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                SPUrlMgt.UpdateOptimizeData(SPUrlMgt.m_objCBox, jsonObj);                parent.SPWebApp.OptimizeSvrSucced(jsonObj);                SPUrlMgt.LoadUserInfo();            } else {                alert("处理失败，请重试...");            }        });    },    ViewOptimize: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenViewOptimize(SPUrlMgt.m_objCBox.data("objItem"));    },    ContinueOptimize: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenOptimizeSvr(SPUrlMgt.m_objCBox.data("objItem"), true);    },    OptimizeReback: function(bUI) {        if (!window.confirm("您确认要退订流量优化服务吗？")) {            return;        }        var objItem = SPUrlMgt.m_objCBox.data("objItem");        var objOptimize = SPUrlMgt.GetOptimize(objItem);        var objUnOptimize = {};        objUnOptimize.urlid = objItem.urlid;        objUnOptimize.odrid = objOptimize.odrid;        objUnOptimize.svcid = "10";        $.post(g_webaction, {            f: 33,            i: String($.toJSON(objUnOptimize))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                if (bUI) {                    parent.SPWebApp.RebackOptimizeSucced(jsonObj.bdelete);                }                var objItem = SPUrlMgt.m_objCBox.data("objItem");                if ("1" == jsonObj.bdelete) {                    for (var i = 0; i < objItem.odrs.length; i++) {                        if ("10" == objItem.odrs[i].svcid) {                            var odrid = objItem.odrs[i].odrid;                            objItem.odrs = $.map(objItem.odrs,                            function(obj) {                                return (odrid == obj.odrid) ? null: obj;                            });                        }                    }                    var aObj = $('<a style="color:#13A013;" target="_self" href="javascript:void(0)">立即开通</a>');                    aObj.click(SPUrlMgt.StartOptimize);                    SPUrlMgt.m_objCBox.parent().parent().children().eq(10).empty().append(aObj);                } else {                    for (var i = 0; i < objItem.odrs.length; i++) {                        if ("10" == objItem.odrs[i].svcid) {                            objItem.odrs[i].etime = jsonObj.etime;                            objItem.odrs[i].sday = jsonObj.sday;                        }                    }                    SPUrlMgt.UpdateOptimize(SPUrlMgt.m_objCBox.parent().parent(), SPUrlMgt.GetOptimize(objItem));                }                var objTrustee = SPUrlMgt.GetTrustee(objItem);                var objOptimize = SPUrlMgt.GetOptimize(objItem);                if ((undefined == objTrustee.odrid) && (undefined == objOptimize.odrid)) {                    SPUrlMgt.m_objCBox.parent().parent().children().eq(1).css("color", "#777777").html("免费");                }                SPUrlMgt.m_objCBox.data("objItem", objItem);            } else {                alert("处理失败，请重试...");            }        });    },    OptimizeRebackEx: function() {        SPUrlMgt.m_objCBox = $(this).parent().parent().parent().parent().parent().parent().children().eq(0).children(":first-child");        SPUrlMgt.OptimizeReback(false);    },    SelectAll: function() {        var bCheck = $(this).attr("checked");        if (bCheck) {            $("#CBox_All_A").attr("checked", "true");            $("#CBox_All_B").attr("checked", "true");            $.each(SPUrlMgt.m_arrCBox,            function(i, obj) {                obj.attr("checked", "true");            });        } else {            $("#CBox_All_A").removeAttr("checked");            $("#CBox_All_B").removeAttr("checked");            $.each(SPUrlMgt.m_arrCBox,            function(i, obj) {                obj.removeAttr("checked");            });        }    },    SelectOne: function() {        var bCheck = $(this).attr("checked");        var nCheck = 0;        if (bCheck) {            $.each(SPUrlMgt.m_arrCBox,            function(i, obj) {                if (obj.attr("checked")) {                    nCheck++;                }            });        } else {            $.each(SPUrlMgt.m_arrCBox,            function(i, obj) {                if (!obj.attr("checked")) {                    nCheck++;                }            });        }        if (nCheck == SPUrlMgt.m_arrCBox.length) {            if (bCheck) {                $("#CBox_All_A").attr("checked", "true");                $("#CBox_All_B").attr("checked", "true");            } else {                $("#CBox_All_A").removeAttr("checked");                $("#CBox_All_B").removeAttr("checked");            };        } else {            $("#CBox_All_A").removeAttr("checked");            $("#CBox_All_B").removeAttr("checked");        }    },    StartAll: function() {        if (!window.confirm(" 您确认要全部开启吗？")) {            return;        }        $.each(SPUrlMgt.m_arrCBox,        function(i, obj) {            if (obj.attr("checked")) {                obj.parent().parent().children().eq(6).find("td").eq(1).find("a").trigger("click", [1]);            }        });    },    StopAll: function() {        if (!window.confirm(" 您确认要全部停止吗？")) {            return;        }        $.each(SPUrlMgt.m_arrCBox,        function(i, obj) {            if (obj.attr("checked")) {                obj.parent().parent().children().eq(6).find("td").eq(1).find("a").trigger("click", [0]);            }        });    },    DeleteAll: function() {        if (!window.confirm(" 您确认要删除网址吗？")) {            return;        }        $.each(SPUrlMgt.m_arrCBox,        function(i, obj) {            if (obj.attr("checked")) {                SPUrlMgt.DoDelete(obj);            }        });    },    DoDelete: function(objCBox) {        var objItem = objCBox.data("objItem");        var objTrustee = SPUrlMgt.GetTrustee(objItem);        var objOptimize = SPUrlMgt.GetOptimize(objItem);        var objDelete = {};        objDelete.urlid = objItem.urlid;        if ((undefined != objTrustee.odrid) || (undefined != objOptimize.odrid)) {            return;        }        $.post(g_webaction, {            f: 23,            i: String($.toJSON(objDelete))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                objCBox.parent().parent().remove();                $("#Span_TotalUrl_Count").html((--SPUrlMgt.m_objOnline.totalurl));                SPUrlMgt.m_arrCBox = $.map(SPUrlMgt.m_arrCBox,                function(obj) {                    return (("id_" + objItem.urlid) == obj.attr("id")) ? null: obj;                });                SPUrlMgt.JustHeight();            }        });    },    ShowOptimize: function() {        parent.SPWebApp.OpenOptimizeSvr(SPUrlMgt.m_objCBox.data("objItem"), false);    },    StartMoreTrustee: function() {        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenMoreTrustee();    },    MoreSubmitTrustee: function(objData) {        $.each(SPUrlMgt.m_arrCBox,        function(i, obj) {            if (obj.attr("checked")) {                SPUrlMgt.DoSubmitTrustee(obj, objData);            }        });    },    DoSubmitTrustee: function(objCBox, objData) {        var obj = objCBox.data("objItem");        var objOrder = SPUrlMgt.GetTrustee(obj);        var objTrustee = {};        objTrustee.urlid = obj.urlid;        if (undefined != objOrder.odrid) {            objTrustee.odrid = objOrder.odrid;            objTrustee.etime = objOrder.etime;            objTrustee.svcid = objOrder.svcid;            objTrustee.nowpay = ("1" == objOrder.status) ? "0": "1";        } else {            objTrustee.odrid = 0;            objTrustee.etime = 0;            objTrustee.nowpay = objData.nowpay;            objTrustee.svcid = objData.svcid;        }        objTrustee.day = objData.day;        $.post(g_webaction, {            f: 32,            i: String($.toJSON(objTrustee))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                SPUrlMgt.UpdateTrusteeData(objCBox, jsonObj);                SPUrlMgt.LoadUserInfo();            }        });    },    UpdateTrusteeData: function(objCBox, jsonObj) {        var objItem = objCBox.data("objItem");        var bExist = false;        var objOrder = {};        objOrder.svcid = jsonObj.svcid;        objOrder.odrid = jsonObj.odrid;        objOrder.btime = jsonObj.btime;        objOrder.etime = jsonObj.etime;        objOrder.price = jsonObj.dayprice;        objOrder.status = jsonObj.status;        objOrder.sday = jsonObj.sday;        for (var i = 0; i < objItem.odrs.length; i++) {            if (("8" == objItem.odrs[i].svcid) || (jsonObj.svcid == objItem.odrs[i].svcid)) {                objItem.odrs[i].odrid = jsonObj.odrid;                objItem.odrs[i].btime = jsonObj.btime;                objItem.odrs[i].etime = jsonObj.etime;                objItem.odrs[i].price = jsonObj.dayprice;                objItem.odrs[i].status = jsonObj.status;                objItem.odrs[i].sday = jsonObj.sday;                bExist = true;                break;            }        }        if (!bExist) {            objItem.odrs.push(objOrder);        }        objCBox.data("objItem", objItem);        SPUrlMgt.UpdateTrustee(objCBox.parent().parent(), objOrder);        if ("1" == objItem.free) {            objCBox.parent().parent().children().eq(6).find("td").eq(0).css("color", "#25A725").html("在线");        } else {            objCBox.parent().parent().children().eq(6).find("td").eq(0).css("color", "#a1a1a1").html("离线");        }        var objTrustee = SPUrlMgt.GetTrustee(objItem);        var objOptimize = SPUrlMgt.GetOptimize(objItem);        if (undefined != objTrustee.odrid) {            switch (parseInt(objTrustee.svcid)) {            case 101:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("1000IP");                break;            case 102:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("2000IP");                break;            case 103:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("3000IP");                break;            case 106:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("6000IP");                break;            case 110:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("10000IP");                break;            case 115:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("15000IP");                break;            case 120:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("20000IP");                break;            default:                objCBox.parent().parent().children().eq(1).css("color", "#800000").html("3000IP");                break;            }        } else if (undefined != objOptimize.odrid) {            objCBox.parent().parent().children().eq(1).css("color", "#800000").html("优化");        } else {            objCBox.parent().parent().children().eq(1).css("color", "#777777").html("免费");        }    },    StartMoreOptimize: function() {        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenMoreOptimize();    },    MoreSubmitOptimize: function(objData) {        $.each(SPUrlMgt.m_arrCBox,        function(i, obj) {            if (obj.attr("checked")) {                SPUrlMgt.DoSubmitOptimize(obj, objData);            }        });    },    DoSubmitOptimize: function(objCBox, objData) {        var obj = objCBox.data("objItem");        var objOrder = SPUrlMgt.GetOptimize(obj);        var objOptimize = {};        objOptimize.urlid = obj.urlid;        if (undefined != objOrder.odrid) {            objOptimize.odrid = objOrder.odrid;            objOptimize.etime = objOrder.etime;            objOptimize.nowpay = ("1" == objOrder.status) ? "0": "1";        } else {            objOptimize.odrid = 0;            objOptimize.etime = 0;            objOptimize.nowpay = objData.nowpay;        }        objOptimize.day = objData.day;        objOptimize.svcid = 10;        $.post(g_webaction, {            f: 32,            i: String($.toJSON(objOptimize))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                SPUrlMgt.UpdateOptimizeData(objCBox, jsonObj);                SPUrlMgt.LoadUserInfo();            }        });    },    UpdateOptimizeData: function(objCBox, jsonObj) {        var objItem = objCBox.data("objItem");        var bExist = false;        var objOrder = {};        objOrder.svcid = 10;        objOrder.odrid = jsonObj.odrid;        objOrder.btime = jsonObj.btime;        objOrder.etime = jsonObj.etime;        objOrder.price = jsonObj.dayprice;        objOrder.status = jsonObj.status;        objOrder.sday = jsonObj.sday;        for (var i = 0; i < objItem.odrs.length; i++) {            if ("10" == objItem.odrs[i].svcid) {                objItem.odrs[i].odrid = jsonObj.odrid;                objItem.odrs[i].btime = jsonObj.btime;                objItem.odrs[i].etime = jsonObj.etime;                objItem.odrs[i].price = jsonObj.dayprice;                objItem.odrs[i].status = jsonObj.status;                objItem.odrs[i].sday = jsonObj.sday;                bExist = true;                break;            }        }        if (!bExist) {            objItem.odrs.push(objOrder);        }        objCBox.data("objItem", objItem);        SPUrlMgt.UpdateOptimize(objCBox.parent().parent(), objOrder);        var objTrustee = SPUrlMgt.GetTrustee(objItem);        var objOptimize = SPUrlMgt.GetOptimize(objItem);        if (undefined != objTrustee.odrid) {} else if (undefined != objOptimize.odrid) {            objCBox.parent().parent().children().eq(1).css("color", "#800000").html("付费");        } else {            objCBox.parent().parent().children().eq(1).css("color", "#777777").html("免费");        }    },    ShowIntroduce: function() {        $("#A_Show_Introduce").hide();        $("#Table_Introduce").fadeIn("slow");        Cookies.set("introduce", "yes");        setTimeout(SPUrlMgt.JustHeight, 800);    },    CloseIntroduce: function() {        $("#A_Show_Introduce").show();        $("#Table_Introduce").fadeOut("slow");        Cookies.set("introduce", "no");        setTimeout(SPUrlMgt.JustHeight, 800);    },    CloneSetInfo: function(objInfo) {        if ("object" == (typeof objInfo.descurlids)) {            objInfo.descurlids = $.makeArray(objInfo.descurlids);        }        $.post(g_webaction, {            f: 27,            i: String($.toJSON(objInfo))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                var objSrcData = null;                $.each(SPUrlMgt.m_arrCBox,                function(i, obj) {                    if (objInfo.srcurlid == obj.data("objItem").urlid) {                        objSrcData = obj.data("objItem");                        return false;                    }                });                if (null != objSrcData) {                    $.each(SPUrlMgt.m_arrCBox,                    function(i, obj) {                        if ( - 1 != $.inArray(obj.data("objItem").urlid, objInfo.descurlids)) {                            var objTagData = obj.data("objItem");                            var objOptimize = SPUrlMgt.GetOptimize(objTagData);                            var bTagCharge = ((undefined != objOptimize.odrid) && (0 != objOptimize.status));                            objOptimize = SPUrlMgt.GetOptimize(objSrcData);                            var bSrcCharge = ((undefined != objOptimize.odrid) && (0 != objOptimize.status));                            objTagData.turl = objSrcData.turl;                            objTagData.usefurl = objSrcData.usefurl;                            if (bTagCharge || (!bTagCharge && !bSrcCharge)) {                                objTagData.usepop = objSrcData.usepop;                                objTagData.useturl = objSrcData.useturl;                                objTagData.furls = objSrcData.furls;                            } else {                                objTagData.usepop = (objSrcData.usepop > 0) ? 5 : 0;                                objTagData.useturl = (((0x00ff & parseInt(objSrcData.useturl)) > 0) ? 1 : 0) | ((0x0100 == (parseInt(objSrcData.useturl) & 0x0f00)) ? 0x0100: 0x0000);                                objTagData.furls = $.grep(objSrcData.furls.split("|"),                                function(n, i) {                                    return i < 2;                                }).join("|");                            }                            obj.data("objItem", objTagData);                        }                    });                    Cookies.set("template", objInfo.srcurlid);                }            }            parent.SPWebApp.MoreSetFinished(jsonObj);        });    },    MoreSetUrl: function() {        parent.SPWebApp.OpenBack();        parent.SPWebApp.OpenMoreSet();    },    SortUrlList: function() {        var sortcookie = Cookies.get("sorttype");        var sorttype = ($("#RD_SortNum").attr("checked")) ? "0": "1";        if (sortcookie != sorttype) {            Cookies.set("sorttype", sorttype);            window.location.reload();        }    },    m_arrCBox: [],    m_objCBox: {},    m_objOnline: {},    m_objTBody: {},    m_objTRItem: {}};