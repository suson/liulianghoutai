$(function() {    $.ajaxSetup({        async: false    });    $.getScript("lib/sp-lib/md5.js");    $.getScript("lib/sp-lib/extent.js");    $.ajaxSetup({        async: true    });    SPPayMgt.WebMain();});var SPPayMgt = {    WebMain: function() {        SPPayMgt.InitEvent();        SPPayMgt.InitPage();        SPPayMgt.PreloadImg();    },    InitEvent: function() {        SPPayMgt.m_objTbody = $("#TBody_Template");        $("#Btn_Start_Pay").click(SPPayMgt.GetMoney);        $("#A_First_Page").click(function() {            if (0 == SPPayMgt.m_curPage) {                return;            }            SPPayMgt.LoadUserRecord(0);        });        $("#A_Prev_Page").click(function() {            if (0 == SPPayMgt.m_curPage) {                return;            }            SPPayMgt.LoadUserRecord(SPPayMgt.m_curPage - 1);        });        $("#A_Next_Page").click(function() {            if ((SPPayMgt.m_curPage + 1) >= SPPayMgt.m_allPage) {                return;            }            SPPayMgt.LoadUserRecord(SPPayMgt.m_curPage + 1);        });        $("#A_Last_Page").click(function() {            if ((SPPayMgt.m_curPage + 1) >= SPPayMgt.m_allPage) {                return;            }            SPPayMgt.LoadUserRecord(SPPayMgt.m_allPage - 1);        });        $("#A_Go_Page").click(SPPayMgt.GoToPage);        SPPayMgt.JustHeight();    },    InitPage: function() {        SPPayMgt.LoadUserInfo();        SPPayMgt.LoadUserRecord(0);    },    Unload: function() {},    PreloadImg: function() {},    JustHeight: function() {        parent.SPWebApp.m_objIframe.css("height", document.body.scrollHeight);        parent.SPWebApp.JustHeight();    },    LoadUserInfo: function() {        $.post(g_webaction, {            f: 7        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                parent.SPWebApp.m_objUser = jsonObj;                parent.SPWebApp.LoadUserInfo();                $("#Span_User_Name").html(parent.SPWebApp.m_objUser.name);                $("#Span_Balance").html(formatCurrency(jsonObj.money / 100));                $("#Span_Pmoney").html(formatCurrency(jsonObj.pmoney / 100));                $("#Span_Lmoney").html(formatCurrency(jsonObj.lmoney / 100));            } else {                alert("登录超时，请重新登录...");                parent.document.location = "clientindex.php";            }        });    },    LoadUserRecord: function(nPage) {        var objRecord = {};        objRecord.page = nPage;        objRecord.pagect = "20";        $.post(g_webaction, {            f: 34,            i: String($.toJSON(objRecord))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                SPPayMgt.m_objTbody.children("tr").not(":last-child").remove();                jsonObj.paylog.reverse();                for (var i = 0; i < jsonObj.paylog.length; i++) {                    var newLog = SPPayMgt.m_objTbody.children("tr:first-child").clone();                    newLog.children("td").eq(0).html(jsonObj.paylog[i].otime);                    if ("4" == jsonObj.paylog[i].otype) {                        newLog.children("td").eq(1).html("在线充值");                        newLog.children("td").eq(2).html("-");                        newLog.children("td").eq(3).html(formatCurrency((jsonObj.paylog[i].val - jsonObj.paylog[i].pm - jsonObj.paylog[i].lm) / 100));                        newLog.children("td").eq(4).html(formatCurrency(jsonObj.paylog[i].pm / 100));                        newLog.children("td").eq(5).html(formatCurrency(jsonObj.paylog[i].lm / 100));                    }                    if (("3" == jsonObj.paylog[i].otype) && (("8" == jsonObj.paylog[i].svcid) || ("101" == jsonObj.paylog[i].svcid) || ("102" == jsonObj.paylog[i].svcid) || ("103" == jsonObj.paylog[i].svcid) || ("106" == jsonObj.paylog[i].svcid) || ("110" == jsonObj.paylog[i].svcid) || ("115" == jsonObj.paylog[i].svcid) || ("120" == jsonObj.paylog[i].svcid))) {                        var strInfo = "";                        switch (parseInt(jsonObj.paylog[i].svcid)) {                        case 101:                            strInfo = "1000IP";                            break;                        case 102:                            strInfo = "2000IP";                            break;                        case 103:                            strInfo = "3000IP";                            break;                        case 106:                            strInfo = "6000IP";                            break;                        case 110:                            strInfo = "10000IP";                            break;                        case 115:                            strInfo = "15000IP";                            break;                        case 120:                            strInfo = "20000IP";                            break;                        default:                            strInfo = "3000IP";                            break;                        }                        newLog.children("td").eq(1).html("网址代挂 - 编号:" + jsonObj.paylog[i].urlid + " - 流量:" + strInfo);                        newLog.children("td").eq(2).html(formatCurrency(jsonObj.paylog[i].val / 100));                        newLog.children("td").eq(3).html("-");                        newLog.children("td").eq(4).html("-");                        newLog.children("td").eq(5).html("-");                    }                    if (("3" == jsonObj.paylog[i].otype) && ("10" == jsonObj.paylog[i].svcid)) {                        newLog.children("td").eq(1).html("流量优化 - 编号:" + jsonObj.paylog[i].urlid);                        newLog.children("td").eq(2).html(formatCurrency(jsonObj.paylog[i].val / 100));                        newLog.children("td").eq(3).html("-");                        newLog.children("td").eq(4).html("-");                        newLog.children("td").eq(5).html("-");                    }                    newLog.children("td").eq(6).html(formatCurrency(jsonObj.paylog[i].bae / 100));                    SPPayMgt.m_objTbody.prepend(newLog.show());                    SPPayMgt.JustHeight();                }                SPPayMgt.m_curPage = nPage;                SPPayMgt.m_allPage = jsonObj.pages;                if (jsonObj.pages > 0) {                    $("#Span_Page_Count").html((SPPayMgt.m_curPage + 1) + "/" + jsonObj.pages);                    $("#Page_Go_To").val(SPPayMgt.m_curPage + 1);                }            }        });    },    GoToPage: function() {        var nToPage = $("#Page_Go_To").val();        if (isNaN(nToPage)) {            alert("请输入有效的页数");            $("#Page_Go_To").val(SPPayMgt.m_curPage + 1).focus().select();            return;        }        if (((SPPayMgt.m_curPage + 1) >= SPPayMgt.m_allPage) || (nToPage < 1) || (nToPage > SPPayMgt.m_allPage)) {            return;        }        SPPayMgt.LoadUserRecord(nToPage - 1);    },    GetMoney: function() {        var nMoney = $("#Pay_Money").val();        if (isNaN(nMoney) || (parseFloat(nMoney) <= 0)) {            alert("请输入有效的充值金额!");            $("#Pay_Money").val("100.00").focus().select();            return;        }        var objPay = {};        objPay.cent = String(nMoney * 100);        $.post(g_webaction, {            f: 18,            i: String($.toJSON(objPay))        },        function(json) {            var jsonObj = $.evalJSON(json);            if ("0" == jsonObj.error) {                parent.SPWebApp.OpenBack();                parent.SPWebApp.OpenPayMoney(jsonObj, nMoney);            } else {                alert("处理充值错误，请重试");            }        });    },    m_curPage: 0,    m_allPage: 0,    m_objTbody: {}};